<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-75757763-1', 'auto');
  ga('send', 'pageview');
  </script>

  <title>Getting PDI on diet to use it on edge processing!</title>
  <meta name="description" content="My name is Miguel Gaspar and the blog purpose is to provide information on the value and how to build IoT and Big Data solutions, providing business, architectural and technical guidance that can be useful to developers, architects and top level business managers. ">
  <meta name="author" content="Miguel Gaspar">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="keywords" content="analytics,big data,iot,social innovation,bi,business intelligence,ctools,pentaho,real-time,realtime,live,insights,analysis,dashboards,artificial intelligence,machine learning'>

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Cooking Analytics">
  <meta name="twitter:description" content="My name is Miguel Gaspar and the blog purpose is to provide information on the value and how to build IoT and Big Data solutions, providing business, architectural and technical guidance that can be useful to developers, architects and top level business managers. ">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Cooking Analytics">
  <meta property="og:description" content="My name is Miguel Gaspar and the blog purpose is to provide information on the value and how to build IoT and Big Data solutions, providing business, architectural and technical guidance that can be useful to developers, architects and top level business managers. ">

  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://localhost:4000//2017/Kettle-on-the-Edge/">
  <link rel="alternate" type="application/rss+xml" title="Cooking Analytics" href="/feed.xml">
</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>
  
<header class="panel-cover" style="background-image: url(/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/" title="link to home of Cooking Analytics">
          <img src="/images/profile.jpg" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Cooking Analytics</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">My name is Miguel Gaspar and the blog purpose is to provide information on the value and how to build IoT and Big Data solutions, providing business, architectural and technical guidance that can be useful to developers, architects and top level business managers. </p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="link to Cooking Analytics blog" class="blog-button">Blog</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">
          
            
              <!-- Twitter -->
              <li class="navigation__item">
                <a href="http://twitter.com/migfgaspar" title="@migfgaspar on Twitter" target="_blank">
                  <i class="icon icon-social-twitter"></i>
                  <span class="label">Twitter</span>
                </a>
              </li>
            

            
              <!-- Facebook -->
              <li class="navigation__item">
                <a href="http://fb.me/miguel.ferreira.gaspar" title="miguel.ferreira.gaspar on Facebook" target="_blank">
                  <i class="icon icon-social-facebook"></i>
                  <span class="label">Facebook</span>
                </a>
              </li>
            

            
              <!-- LinkedIn -->
              <li class="navigation__item">
                <a href="https://www.linkedin.com/in/mfgaspar" title="mfgaspar on LinkedIn" target="_blank">
                  <i class="icon icon-social-linkedin"></i>
                  <span class="label">LinkedIn</span>
                </a>
              </li>
            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/mfgaspar" title="mfgaspar on GitHub" target="_blank">
                  <i class="icon icon-social-github"></i>
                  <span class="label">GitHub</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:miguel.ferreira.gaspar@gmail.com" title="Email miguel.ferreira.gaspar@gmail.com" target="_blank">
                  <i class="icon icon-mail"></i>
                  <span class="label">Email</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/feed.xml" title="Subscribe" target="_blank">
                <i class="icon icon-rss"></i>
                <span class="label">RSS</span>
              </a>
            </li>
          
            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="30 Dec 2017" class="post-meta__date date">30 Dec 2017</time> &#8226; <span class="post-meta__tags">on <a href="/tags/#IoT">IoT</a> <a href="/tags/#Pentaho">Pentaho</a> <a href="/tags/#Data Integration">Data Integration</a> <a href="/tags/#Kettle">Kettle</a> <a href="/tags/#Edge">Edge</a> <a href="/tags/#Kitchen">Kitchen</a> <a href="/tags/#Pan">Pan</a> </span>
    </div>
    <h1 class="post-title">Getting PDI on diet to use it on edge processing!</h1>
  </header>
  <section class="post">
    <p>One of the thinks that is important to consider when designing and creating IoT solutions is edge computing. So, can we leverage Pentaho Data Integration for edge processing?</p>

<h1 id="pentaho-data-integration-on-the-edge">Pentaho Data Integration On the Edge!</h1>

<p>Most of the times you don’t want to send all the data from all the sensor to a central deposit, but only send the data.
Edge computing allows is useful in many use cases and one example is to have data produced by Internet of Things (IoT) devices processed closer to where it is created instead of sending it all across long distances to data centers or clouds. If we do edge computing we will definitely save on costs, faster response time creating a better overall solution that is still capable of fulfilling project requirements.</p>

<p><a href="https://www.networkworld.com/article/3224893/internet-of-things/what-is-edge-computing-and-how-it-s-changing-the-network.html">Here</a>, you will find a simple article on the subject.</p>

<p>You may ask, how “big” will be my edge device or gateway and how much will I need to perform on the edge? Well, that depends on your goals and project requirements, but I almost bet that you can now think on many ways to improve your solution. Anyhow I am sure that for edge we usually want some technology that is light and performant, easy to develop with.</p>

<p>You might struggle to find many edge solutions that will perform all operations you need, so most of the times you will find that most time you need to get hands dirty and create some custom code.</p>

<p>To reduce your solution time to market, you can also make use of tools that will allows you to save time when it comes to data processing and analysis and apply artificial intelligence on it. One of those tools is Pentaho Data Integration.</p>

<p>One of the problem of amazing tools is that they get big and sometimes they provide much more then we need for simpler, anyhow more complex tasks.</p>

<h2 id="so-can-we-use-pentaho-data-integration-for-edge-processing">So, can we use Pentaho Data Integration for Edge processing?</h2>

<p>The answer is off course, yes, we can!</p>

<p>But PDI is a greater and more advanced tool with much more features and functionality that we need for edge computing, so why not using only what we can, having a tiny data integration tool were you just add what you need? Of course, that if you still need more than its core components or parts, you should be able to do it. I guess that the solution would be to start from base and core functionality and add the components and/or plugins we need for specific operations.</p>

<p>On Edge devices or gateways you will probably be executing Kitchen, Pan or even Carte. The use of OSGI and some plugins that are included by default makes Spoon and associated command line tools to be a bit slow at start. So, we need to do some adjustments on Pentaho Data Integration and use a lighter but still powerful version of it.</p>

<h2 id="lets-get-to-the-point-and-check-what-it-can-be-done-on-that-sense">Let’s get to the point and check what it can be done on that sense</h2>

<p>First, I need to raise a warning, this is not supported by Pentaho, so you need to do/use it on your own risk!</p>

<p>Second, I need to set some of the goals/objectives:</p>
<ul>
  <li>Start with core and base kettle tool that provides essential functionality for edge processing;</li>
  <li>The goal was to find an easier solution, and avoid having to recompile kettle on every change;</li>
  <li>To be able to re-include plugins as we need;</li>
  <li>Consume as less memory, cpu and disk space as possible.</li>
</ul>

<p>Let me know if you find issues and please contribute with improvements. Share experiences and feedback while using it! We can make it much better, I just spend couple of hours putting this in place, so I know that lots of improvements can be done.</p>

<h2 id="getting-pdi-on-a-diet">Getting PDI on a diet</h2>

<p>Looking to plugins and some of the functionality under OSGI, it’s not required for edge computing, so, I have removed OSGI and OSGI plugins plus plugins that you might add later without any issues if we need to use them. You must be aware that by removing OSGI, you also remove some of PDI functionality, but you might be completely fine with that. You won’t be able to connect to repository, won’t be able to use Big Data shims, Yarn, Adaptive Execution Layer (AEL), Data Lineage and remote execution.</p>

<p>Yes, I will miss DET, but I can survive with that. I can even do development with a version were OSGI is available but having proper continuous integration process in place to perform proper testing using edge version.</p>

<p>Also, there are plugins that most of the time we don’t use, and that most of the time wont be required for edge computing.</p>

<p><strong>Less than 160MB of Pentaho Data Integration to be used!</strong></p>

<p>I have reduced components to a core and had not to recompile Kettle. So, now I do have a Kettle solution that takes less then 170 MB of disk space and consumes less computing recourses so better efficiency while doing edge processing, just by running and maybe designing your kettle transformations and jobs on the edge.</p>

<p>So, what were the main transformation I did?</p>

<h3 id="removing-osgi-and-dependencies">Removing OSGI and dependencies</h3>

<p>We can remove Karaf/OSGI listeners but there are still some dependencies that will stop spoon to start. Even if it only this change, works good on kitchen and pan, spoon would break, and I wanted to have spoon also running. So, I had to remove dependencies from PentahoSystem.java class and recompile it. But that’s how much I had to do have lightning fast startup also on Spoon. No need to recompile Kettle code, only had to replace the jar file from Pentaho platform code.</p>

<h3 id="plugins-removed">Plugins removed:</h3>

<p>I have removed most of the plugins that are inside the plugins folder except for essential as json, xlm, platform utils, core plugins, dummy (yes we should avoid using it, but it is quite useful sometimes)</p>

<p>Samples were also removed to save disk space and have faster deploy process. Karaf folder was completely removed.</p>

<p>I will make the list more accurate and precise once time permits. The list will be available in <a href="https://github.com/mfgaspar/orlo">this</a> github repository, I have called the repository “Orlo”, that is edge in Italy, where I was when worked on this.</p>

<h3 id="how-to-install-it-and-run-spoon-kitchen-pan-and-carte">How to install it and run Spoon, Kitchen, Pan and Carte?</h3>

<p>You can find a zip file with thin PDI using this <a href="https://github.com/mfgaspar/orlo/releases/download/8.0.0.0-28/orlo-pdi-8.0.0.0-28.zip">link</a></p>

<p>Once you download the zip file in <a href="https://github.com/mfgaspar/orlo/releases/download/8.0.0.0-28/orlo-pdi-8.0.0.0-28.zip">here</a> you just need to unzip and start Spoon, Kitchen and Pan from the command line as you would to it normally, just like the example below. Don’t forget to optimize JVM memory, point to specific Kettle Home folder, etc..</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sh kitchen.sh <span class="nt">-file</span> ../etl/job.kjb <span class="nt">-level</span> Error <span class="nt">-logfile</span> ../joblog.log
</code></pre></div></div>

<p>You will see the job/transformation is started instantaneously, and no starting overhead. If you measure the execution time (by any mean you might have), plus memory and cpu (that you easily do using jconsole) you will be able how much you’ve improved.</p>

<p>Unfortunately, I had to leave Windows out of this, anyhow as for now I don’t see windows as the operating system for edge computing. Just a reminder that you can still develop the transformations and jobs in Windows but having proper tests in place to make sure that you’ve developed will work on the Edge version of Pentaho Data Integration.</p>

<p>Have fun creating jobs and transformations to be used on edge processing on small and scarse resources devices.</p>

<p>NOTE: This is great solution not only for Edge processing but can also be used in solutions that uses “serverless” and part of the backend, as Dan Keeley has already mentioned on a post on his blog. Some other uses cases are cloud and elastic computing that I will later write a post about it.</p>

<p>Follow me at:</p>


  </section>
  
</article>
 
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-571518f68ebfed3f"></script>


<a href="https://api.addthis.com/oexchange/0.8/forward/twitter/offer?url=http://localhost:4000/2017/Kettle-on-the-Edge/&text=&pco=tbxnj-1.0&pubid=&ct=1" target="_blank"><img src="https://cache.addthiscdn.com/icons/v3/thumbs/32x32/twitter.png" border="0" alt="Twitter"/></a>

<a href="https://api.addthis.com/oexchange/0.8/forward/linkedin/offer?url=http://localhost:4000/2017/Kettle-on-the-Edge/&pubid=&ct=1&summary=&pco=tbxnj-1.0" target="_blank"><img src="https://cache.addthiscdn.com/icons/v3/thumbs/32x32/linkedin.png" border="0" alt="LinkedIn"/></a>

<a href="https://api.addthis.com/oexchange/0.8/forward/facebook/offer?url=http://localhost:4000/2017/Kettle-on-the-Edge/&pubid=&ct=1&title=&pco=tbxnj-1.0" target="_blank"><img src="https://cache.addthiscdn.com/icons/v3/thumbs/32x32/facebook.png" border="0" alt="Facebook"/></a>

<a href="https://api.addthis.com/oexchange/0.8/forward/google_plus_one/offer?url=http://localhost:4000/2017/Kettle-on-the-Edge/&pubid=&ct=1&title=&pco=tbxnj-1.0" target="_blank"><img src="https://cache.addthiscdn.com/icons/v3/thumbs/32x32/google_plusone_share.png" border="0" alt="Google+"/></a>
<!--
<a href="https://api.addthis.com/oexchange/0.8/forward/link/offer?url=http%3A%2F%2Fwww.addthis.com&pubid=ra-571518f68ebfed3f&ct=1&title=AddThis%20-%20Get%20likes%2C%20get%20shares%2C%20get%20followers&pco=tbxnj-1.0" target="_blank"><img src="https://cache.addthiscdn.com/icons/v3/thumbs/32x32/link.png" border="0" alt="Copy Link"/></a>
-->

<div id="disqus_thread"></div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//cookinganalytics.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>






      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2018 Miguel Gaspar. All rights reserved.</span>
</footer> 

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75757763-1', 'auto');
  ga('send', 'pageview');
</script>

    </div>
  </body>
</html>